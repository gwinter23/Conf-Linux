
nano /etc/rsyslog.d/syslog1-syslog.conf 

# make gtls driver the default and set certificate files
global(
DefaultNetstreamDriver="gtls"
DefaultNetstreamDriverCAFile="/etc/rsyslog.d/chain.pem"
DefaultNetstreamDriverCertFile="/etc/rsyslog.d/cert.pem"
DefaultNetstreamDriverKeyFile="/etc/rsyslog.d/privkey.pem"
)

# load TCP listener
module(
load="imtcp"
StreamDriver.Name="gtls"
StreamDriver.Mode="1"
StreamDriver.Authmode="anon"
)

# start up listener at port 6514
input(
type="imtcp"
port="6514"
)


###
Apparmor check if blocked :
###

nano /etc/apparmor.d/usr.sbin.rsyslogd

berfore } input :

  /etc/rsyslog-ssl/*.pem r,

##
Permission
##

mkdir /etc/rsyslog-ssl

chown root:syslog /etc/rsyslog-ssl
chmod 750 /etc/rsyslog-ssl

chown root:syslog /etc/rsyslog-ssl/*.pem
chmod 640 /etc/rsyslog-ssl/*.pem

###
Pakage 
###
apt install rsyslog-gnutls


###
Start Rsyslog and monitoring
###

systemctl status rsyslog 
systemctl stop rsyslog
systemctl start rsyslog

systemctl restart rsyslog 

If any error you can check on log syslog default : /var/log/syslog
